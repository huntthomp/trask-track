name: task-tracker
services:
    db:
        image: postgres:16
        container_name: task-traccker-db
        restart: unless-stopped
        environment:
            POSTGRES_USER: ${POSTGRES_USER}
            POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
            POSTGRES_DB: ${POSTGRES_DB}
        ports:
            - "5432:5432"
        volumes:
            - postgres_data:/var/lib/postgresql/data
            - ./init/db:/docker-entrypoint-initdb.d

    filestore:
        build:
            context: .
            dockerfile: ./docker/Dockerfile.minio
        container_name: task-traccker-filestore
        restart: unless-stopped
        ports:
            - "9000:9000"
            - "9001:9001"
        environment:
            MINIO_ROOT_USER: ${MINIO_ROOT_USER}
            MINIO_ROOT_PASSWORD: ${MINIO_ROOT_PASSWORD}
        volumes:
            - filestore_data:/data
            - ./init/minio:/docker-entrypoint-init.d

volumes:
    filestore_data:
    postgres_data:
